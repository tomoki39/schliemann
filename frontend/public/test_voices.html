<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>éŸ³å£°ãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ« - Schliemann</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      max-width: 1200px;
      margin: 20px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .container {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    h1 { color: #333; margin-bottom: 10px; }
    h2 { color: #555; margin-top: 30px; margin-bottom: 15px; font-size: 1.3em; }
    .subtitle { color: #666; margin-bottom: 30px; }
    .test-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }
    .test-card {
      border: 1px solid #e0e0e0;
      padding: 15px;
      border-radius: 6px;
      background: #fafafa;
    }
    .test-card h3 {
      margin: 0 0 10px 0;
      font-size: 1.1em;
      color: #333;
    }
    .test-text {
      background: #f0f0f0;
      padding: 8px;
      border-radius: 4px;
      margin: 10px 0;
      font-size: 0.9em;
      color: #555;
    }
    button {
      background: #4CAF50;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      margin-right: 10px;
      margin-top: 10px;
    }
    button:hover { background: #45a049; }
    button.secondary {
      background: #2196F3;
    }
    button.secondary:hover { background: #0b7dda; }
    .info {
      background: #e3f2fd;
      padding: 10px;
      border-radius: 4px;
      margin: 10px 0;
      font-size: 0.85em;
    }
    .success { background: #c8e6c9; }
    .warning { background: #fff9c4; }
    .error { background: #ffcdd2; }
    .status {
      margin-top: 10px;
      padding: 8px;
      border-radius: 4px;
      font-size: 0.85em;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ¤ éŸ³å£°å“è³ªãƒ†ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«</h1>
    <p class="subtitle">å„è¨€èªã®ãƒã‚¤ãƒ†ã‚£ãƒ–ç™ºéŸ³ãŒæ­£ã—ãé¸æŠã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã§ãã¾ã™</p>

    <div class="info">
      <strong>ğŸ“Œ ä½¿ã„æ–¹:</strong><br>
      1. ã€Œå…¨éŸ³å£°ã‚’ç¢ºèªã€ãƒœã‚¿ãƒ³ã§ãƒ–ãƒ©ã‚¦ã‚¶ã«ä½•ã®éŸ³å£°ãŒã‚ã‚‹ã‹ç¢ºèª<br>
      2. å„è¨€èªã®ã€Œãƒ†ã‚¹ãƒˆã€ãƒœã‚¿ãƒ³ã§éŸ³å£°é¸æŠã‚’ãƒ†ã‚¹ãƒˆ<br>
      3. ã€Œå†ç”Ÿã€ãƒœã‚¿ãƒ³ã§å®Ÿéš›ã®ç™ºéŸ³ã‚’ç¢ºèª
    </div>

    <button class="secondary" onclick="logAllVoices()">ğŸ“¢ å…¨éŸ³å£°ã‚’ç¢ºèªï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«ï¼‰</button>
    <button class="secondary" onclick="showVoiceStats()">ğŸ“Š éŸ³å£°çµ±è¨ˆã‚’è¡¨ç¤º</button>

    <h2>ğŸŒ ã‚¢ã‚¸ã‚¢è¨€èª</h2>
    <div class="test-grid" id="asian-languages"></div>

    <h2>ğŸŒ ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘è¨€èª</h2>
    <div class="test-grid" id="european-languages"></div>

    <h2>ğŸŒ ä¸­æ±ãƒ»ã‚¢ãƒ•ãƒªã‚«è¨€èª</h2>
    <div class="test-grid" id="middle-east-languages"></div>

    <div id="stats" class="info" style="margin-top: 30px; display: none;"></div>
  </div>

  <script>
    // è¨€èªãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
    const testLanguages = {
      asian: [
        { code: 'vie', name: 'ãƒ™ãƒˆãƒŠãƒ èª', text: 'Xin chÃ o, báº¡n khá»e khÃ´ng?', locale: 'vi-VN' },
        { code: 'tha', name: 'ã‚¿ã‚¤èª', text: 'à¸ªà¸§à¸±à¸ªà¸”à¸µà¸„à¸£à¸±à¸š à¸„à¸¸à¸“à¸ªà¸šà¸²à¸¢à¸”à¸µà¹„à¸«à¸¡', locale: 'th-TH' },
        { code: 'kor', name: 'éŸ“å›½èª', text: 'ì•ˆë…•í•˜ì„¸ìš”, ì˜¤ëŠ˜ ì–´ë– ì„¸ìš”?', locale: 'ko-KR' },
        { code: 'hin', name: 'ãƒ’ãƒ³ãƒ‡ã‚£ãƒ¼èª', text: 'à¤¨à¤®à¤¸à¥à¤•à¤¾à¤°, à¤†à¤ª à¤†à¤œ à¤•à¥ˆà¤¸à¥‡ à¤¹à¥ˆà¤‚?', locale: 'hi-IN' },
        { code: 'ben', name: 'ãƒ™ãƒ³ã‚¬ãƒ«èª', text: 'à¦¹à§à¦¯à¦¾à¦²à§‹, à¦†à¦ªà¦¨à¦¿ à¦•à§‡à¦®à¦¨ à¦†à¦›à§‡à¦¨?', locale: 'bn-IN' },
        { code: 'ind', name: 'ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢èª', text: 'Halo, apa kabar?', locale: 'id-ID' },
        { code: 'msa', name: 'ãƒãƒ¬ãƒ¼èª', text: 'Hai, apa khabar?', locale: 'ms-MY' },
        { code: 'fil', name: 'ãƒ•ã‚£ãƒªãƒ”ãƒ³èª', text: 'Kumusta ka?', locale: 'fil-PH' },
      ],
      european: [
        { code: 'fra', name: 'ãƒ•ãƒ©ãƒ³ã‚¹èª', text: 'Bonjour, comment allez-vous?', locale: 'fr-FR' },
        { code: 'deu', name: 'ãƒ‰ã‚¤ãƒ„èª', text: 'Hallo, wie geht es Ihnen?', locale: 'de-DE' },
        { code: 'ita', name: 'ã‚¤ã‚¿ãƒªã‚¢èª', text: 'Ciao, come stai?', locale: 'it-IT' },
        { code: 'rus', name: 'ãƒ­ã‚·ã‚¢èª', text: 'Ğ—Ğ´Ñ€Ğ°Ğ²ÑÑ‚Ğ²ÑƒĞ¹Ñ‚Ğµ, ĞºĞ°Ğº Ğ´ĞµĞ»Ğ°?', locale: 'ru-RU' },
        { code: 'pol', name: 'ãƒãƒ¼ãƒ©ãƒ³ãƒ‰èª', text: 'CzeÅ›Ä‡, jak siÄ™ masz?', locale: 'pl-PL' },
        { code: 'nld', name: 'ã‚ªãƒ©ãƒ³ãƒ€èª', text: 'Hallo, hoe gaat het?', locale: 'nl-NL' },
        { code: 'swe', name: 'ã‚¹ã‚¦ã‚§ãƒ¼ãƒ‡ãƒ³èª', text: 'Hej, hur mÃ¥r du?', locale: 'sv-SE' },
        { code: 'ell', name: 'ã‚®ãƒªã‚·ãƒ£èª', text: 'Î“ÎµÎ¹Î± ÏƒÎ±Ï‚, Ï„Î¹ ÎºÎ¬Î½ÎµÏ„Îµ;', locale: 'el-GR' },
      ],
      middleEast: [
        { code: 'arb', name: 'ã‚¢ãƒ©ãƒ“ã‚¢èª', text: 'Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ ÙƒÙŠÙ Ø­Ø§Ù„ÙƒØŸ', locale: 'ar-SA' },
        { code: 'tur', name: 'ãƒˆãƒ«ã‚³èª', text: 'Merhaba, nasÄ±lsÄ±nÄ±z?', locale: 'tr-TR' },
        { code: 'heb', name: 'ãƒ˜ãƒ–ãƒ©ã‚¤èª', text: '×©×œ×•×, ××” ×©×œ×•××š?', locale: 'he-IL' },
        { code: 'fas', name: 'ãƒšãƒ«ã‚·ãƒ£èª', text: 'Ø³Ù„Ø§Ù…ØŒ Ú†Ø·ÙˆØ±ÛŒØ¯ØŸ', locale: 'fa-IR' },
      ]
    };

    const isoMap = {
      eng: 'en-US', fra: 'fr-FR', fre: 'fr-FR', spa: 'es-ES', por: 'pt-PT', 
      deu: 'de-DE', ger: 'de-DE', ita: 'it-IT', rus: 'ru-RU', 
      nld: 'nl-NL', dut: 'nl-NL', pol: 'pl-PL', ukr: 'uk-UA',
      jpn: 'ja-JP', kor: 'ko-KR', vie: 'vi-VN', tha: 'th-TH', 
      hin: 'hi-IN', ben: 'bn-IN', cmn: 'zh-CN', yue: 'zh-HK',
      arb: 'ar-SA', ara: 'ar-SA', heb: 'he-IL', tur: 'tr-TR', 
      fas: 'fa-IR', per: 'fa-IR', ind: 'id-ID', msa: 'ms-MY', fil: 'fil-PH',
      ell: 'el-GR', swe: 'sv-SE', nld: 'nl-NL', pol: 'pl-PL'
    };

    function selectVoice(languageCode) {
      const voices = speechSynthesis.getVoices();
      const normalized = isoMap[languageCode] || languageCode;
      const normalizedPrimary = normalized.split('-')[0];

      // ã‚¯ãƒ©ã‚¦ãƒ‰éŸ³å£°ã‚’å„ªå…ˆçš„ã«é¸æŠ
      let voice = voices.find(v => 
        v.lang.toLowerCase() === normalized.toLowerCase() && !v.localService
      );
      if (!voice) {
        voice = voices.find(v => 
          v.lang.toLowerCase() === normalized.toLowerCase()
        );
      }
      if (!voice) {
        voice = voices.find(v => 
          v.lang.toLowerCase().startsWith(normalizedPrimary + '-') && !v.localService
        );
      }
      if (!voice) {
        voice = voices.find(v => 
          v.lang.toLowerCase().startsWith(normalizedPrimary)
        );
      }

      return voice || voices[0];
    }

    function testVoiceSelection(code, name, locale) {
      const voice = selectVoice(code);
      const statusId = `status-${code}`;
      const statusEl = document.getElementById(statusId);
      
      if (voice) {
        const isCorrect = voice.lang.toLowerCase().startsWith(locale.split('-')[0]);
        const isCloud = !voice.localService;
        const className = isCorrect ? (isCloud ? 'success' : 'warning') : 'error';
        statusEl.className = `status ${className}`;
        statusEl.innerHTML = `
          âœ… é¸æŠ: ${voice.name}<br>
          ğŸŒ è¨€èª: ${voice.lang}<br>
          ${isCloud ? 'â˜ï¸ CloudéŸ³å£°' : 'ğŸ’» LocaléŸ³å£°'}
        `;
        console.log(`âœ… ${name} (${code}): ${voice.name} (${voice.lang}) ${isCloud ? '[Cloud]' : '[Local]'}`);
      } else {
        statusEl.className = 'status error';
        statusEl.innerHTML = 'âŒ éŸ³å£°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“';
        console.log(`âŒ ${name} (${code}): No voice found`);
      }
    }

    function playVoice(code, text) {
      const voice = selectVoice(code);
      if (!voice) {
        alert('éŸ³å£°ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
        return;
      }

      speechSynthesis.cancel();
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.voice = voice;
      utterance.lang = voice.lang;
      utterance.rate = 1.0;
      utterance.pitch = 1.0;
      utterance.volume = 1.0;

      console.log(`ğŸ¤ Playing: ${text}`);
      console.log(`   Voice: ${voice.name} (${voice.lang})`);

      speechSynthesis.speak(utterance);
    }

    function createTestCard(lang, containerId) {
      const card = document.createElement('div');
      card.className = 'test-card';
      card.innerHTML = `
        <h3>${lang.name}</h3>
        <div class="test-text">${lang.text}</div>
        <button onclick="testVoiceSelection('${lang.code}', '${lang.name}', '${lang.locale}')">ğŸ” ãƒ†ã‚¹ãƒˆ</button>
        <button onclick="playVoice('${lang.code}', '${lang.text}')">â–¶ï¸ å†ç”Ÿ</button>
        <div id="status-${lang.code}" class="status info">ã€Œãƒ†ã‚¹ãƒˆã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„</div>
      `;
      document.getElementById(containerId).appendChild(card);
    }

    function logAllVoices() {
      const voices = speechSynthesis.getVoices();
      const byLang = {};
      voices.forEach(v => {
        const lang = v.lang.split('-')[0];
        if (!byLang[lang]) byLang[lang] = [];
        byLang[lang].push(v);
      });

      console.log('ğŸ“¢ Available Voices by Language:');
      Object.keys(byLang).sort().forEach(lang => {
        console.log(`\n${lang}:`);
        byLang[lang].forEach(v => {
          console.log(`  - ${v.name} (${v.lang}) ${v.localService ? '[Local]' : '[Cloud]'}`);
        });
      });
    }

    function showVoiceStats() {
      const voices = speechSynthesis.getVoices();
      const cloudVoices = voices.filter(v => !v.localService);
      const localVoices = voices.filter(v => v.localService);
      const languages = new Set(voices.map(v => v.lang.split('-')[0]));

      const statsEl = document.getElementById('stats');
      statsEl.style.display = 'block';
      statsEl.innerHTML = `
        <strong>ğŸ“Š éŸ³å£°çµ±è¨ˆ:</strong><br>
        åˆè¨ˆéŸ³å£°æ•°: ${voices.length}å€‹<br>
        ã‚¯ãƒ©ã‚¦ãƒ‰éŸ³å£°: ${cloudVoices.length}å€‹<br>
        ãƒ­ãƒ¼ã‚«ãƒ«éŸ³å£°: ${localVoices.length}å€‹<br>
        å¯¾å¿œè¨€èªæ•°: ${languages.size}è¨€èª
      `;
      
      console.log('ğŸ“Š Voice Statistics:', {
        total: voices.length,
        cloud: cloudVoices.length,
        local: localVoices.length,
        languages: languages.size
      });
    }

    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«éŸ³å£°ãƒªã‚¹ãƒˆã‚’æº–å‚™
    function init() {
      // éŸ³å£°èª­ã¿è¾¼ã¿å¾…æ©Ÿ
      let loaded = false;
      speechSynthesis.onvoiceschanged = () => {
        if (!loaded) {
          loaded = true;
          testLanguages.asian.forEach(lang => createTestCard(lang, 'asian-languages'));
          testLanguages.european.forEach(lang => createTestCard(lang, 'european-languages'));
          testLanguages.middleEast.forEach(lang => createTestCard(lang, 'middle-east-languages'));
        }
      };
      
      // å³åº§ã«å®Ÿè¡Œã‚‚è©¦ã¿ã‚‹
      setTimeout(() => {
        if (speechSynthesis.getVoices().length > 0 && !loaded) {
          loaded = true;
          testLanguages.asian.forEach(lang => createTestCard(lang, 'asian-languages'));
          testLanguages.european.forEach(lang => createTestCard(lang, 'european-languages'));
          testLanguages.middleEast.forEach(lang => createTestCard(lang, 'middle-east-languages'));
        }
      }, 100);
    }

    init();
  </script>
</body>
</html>
